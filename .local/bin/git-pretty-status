#!/bin/bash

# Define colors and icons
COLOR_RED="\033[0;31m"
COLOR_GREEN="\033[0;32m"
COLOR_YELLOW="\033[0;33m"
COLOR_BLUE="\033[0;34m"
COLOR_MAGENTA="\033[0;35m"
COLOR_CYAN="\033[0;36m"
COLOR_RESET="\033[0m"

ICON_MODIFIED=""
ICON_ADDED=""
ICON_UNTRACKED=""
ICON_RENAMED=""
ICON_DELETED=""
ICON_STAGED="󰄲"
ICON_BOTH="󰄫"

git status --porcelain=v1 | while IFS= read -r line; do
    xy_status="${line:0:2}"
    file_path="${line:3}"
    
    x="${xy_status:0:1}"  # staged
    y="${xy_status:1:1}"  # unstaged

    staging_indicator=""
    if [[ "$x" != " " && "$y" != " " ]]; then
        staging_indicator="${COLOR_MAGENTA}${ICON_BOTH}${COLOR_RESET}"
    elif [[ "$x" != " " ]]; then
        staging_indicator="${COLOR_CYAN}${ICON_STAGED}${COLOR_RESET}"
    fi

    case "$xy_status" in
        # Staged changes
        "M ") echo -e "${staging_indicator} ${COLOR_YELLOW}${ICON_MODIFIED} Modified:${COLOR_RESET}    ${file_path}" ;;
        "A ") echo -e "${staging_indicator} ${COLOR_GREEN}${ICON_ADDED} Added:${COLOR_RESET}       ${file_path}" ;;
        "D ") echo -e "${staging_indicator} ${COLOR_RED}${ICON_DELETED} Deleted:${COLOR_RESET}     ${file_path}" ;;
        "R ") echo -e "${staging_indicator} ${COLOR_BLUE}${ICON_RENAMED} Renamed:${COLOR_RESET}     ${file_path}" ;;
        "C ") echo -e "${staging_indicator} ${COLOR_BLUE}${ICON_RENAMED} Copied:${COLOR_RESET}      ${file_path}" ;;
        
        # Unstaged changes (no extra staging icon)
        " M") echo -e "   ${COLOR_YELLOW}${ICON_MODIFIED} Modified:${COLOR_RESET}    ${file_path}" ;;
        " D") echo -e "   ${COLOR_RED}${ICON_DELETED} Deleted:${COLOR_RESET}     ${file_path}" ;;
        
        # Both staged and unstaged
        "MM"|"AM"|"AD"|"MD")
            echo -e "${staging_indicator} ${COLOR_YELLOW}${ICON_MODIFIED} Modified:${COLOR_RESET}    ${file_path}" ;;
        
        # Untracked files
        "??") echo -e "   ${COLOR_RED}${ICON_UNTRACKED}${COLOR_RESET} Untracked:${COLOR_RESET}  ${file_path}" ;;
        
        # Ignored files  
        "!!") echo -e "   ${COLOR_MAGENTA}󰿠 Ignored:${COLOR_RESET}    ${file_path}" ;;
        
        # Conflicts
        "UU"|"AA"|"DD") echo -e "   ${COLOR_RED}󰞇 Conflict:${COLOR_RESET}   ${file_path}" ;;
        
        # Fallback
        *) echo -e "${staging_indicator} ${COLOR_YELLOW}${xy_status}${COLOR_RESET}              ${file_path}" ;;
    esac
done
